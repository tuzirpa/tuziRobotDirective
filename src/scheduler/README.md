# 任务调度组使用指南

## 概述
任务调度组提供了统一的任务调度功能，支持多种执行模式，包括立即执行、延迟执行、定时重复执行等。采用函数式设计，返回执行对象进行状态管理。

## 核心组件

### 1. 创建任务 (`createTask`) 📝 控制结构
- **功能**: 创建一个任务函数，用户在指令块中定义具体的任务逻辑
- **输入**: 任务名称
- **输出**: 任务函数对象
- **使用方式**: 
  ```
  创建任务 "我的任务"
    // 在这里编写具体的任务逻辑
    日志打印 "任务正在执行"
    // 可以添加更多指令
  创建任务结束标记
  ```
- **说明**: 这是一个控制结构，类似定时任务指令，用户可以在其中定义任务的具体执行内容

### 2. 调度任务 (`schedule`) ⭐ 核心指令
- **功能**: 统一的调度指令，通过参数控制执行模式
- **输入**: 
  - 任务函数：要执行的任务函数（由创建任务指令产生）
  - 执行模式：立即执行/延迟执行/定时重复执行/一次性延迟执行
  - 延迟时间：初始延迟时间（秒）
  - 重复间隔：重复执行时的间隔时间（秒）
  - 最大执行次数：0为无限制
- **输出**: 执行对象（包含状态信息和控制方法）

### 3. 获取任务状态 (`getTaskStatus`)
- **功能**: 查询任务执行状态
- **输入**: 执行对象
- **输出**: 状态信息对象

### 4. 停止任务 (`stopTask`)
- **功能**: 停止正在运行的任务
- **输入**: 执行对象
- **输出**: 停止结果

### 5. 调度结束标记 (`scheduleEnd`)
- **功能**: 标记调度任务代码块的结束

### 6. 创建任务结束标记 (`createTaskEnd`)
- **功能**: 标记创建任务代码块的结束

## 执行模式详解

### 1. 立即执行 (`immediate`)
```
立即开始执行任务，无延迟
```

### 2. 延迟执行 (`delay`)
```
等待指定时间后执行一次
```

### 3. 定时重复执行 (`repeat`) 🔄
```
等待初始延迟时间后开始执行，每次执行完成后等待重复间隔时间再次执行
类似您要求的 setTimeout 递归模式
```

### 4. 一次性延迟执行 (`once`)
```
等待指定时间后执行一次，执行完毕后结束
```

## 执行对象功能

执行对象包含以下方法和属性：

### 状态属性
- `id`: 唯一标识符
- `mode`: 执行模式
- `status`: 当前状态（created/running/paused/stopped/completed/failed）
- `isRunning`: 是否正在运行
- `isActive`: 是否激活状态
- `currentExecutions`: 当前执行次数
- `maxExecutions`: 最大执行次数
- `createdAt`: 创建时间
- `startedAt`: 开始时间
- `stoppedAt`: 停止时间

### 控制方法
- `getStatus()`: 获取状态信息
- `stop()`: 停止任务执行
- `pause()`: 暂停任务（如果正在运行）
- `resume()`: 恢复任务（如果已暂停）

## 使用示例

### 完整使用流程
1. **创建任务**：
   ```
   创建任务 "数据处理任务"
     日志打印 "开始处理数据"
     设置变量 result "处理完成"
     日志打印 result
   创建任务结束标记
   ```

2. **调度任务**：
   ```
   调度任务 taskFunction "repeat" 延迟时间=2 重复间隔=5 最大执行次数=10
     // 这里可以添加额外的调度逻辑（可选）
   调度结束标记
   ```

3. **状态管理**：
   ```
   获取任务状态 executionObject → statusInfo
   停止任务 executionObject → stopResult
   ```

### setTimeout 递归实现示例
```
1. 创建任务 "定时检查任务"
     日志打印 "执行定时检查"
     // 添加具体的检查逻辑
   创建任务结束标记

2. 调度任务 taskFunction 
   - 执行模式：定时重复执行
   - 延迟时间：1秒
   - 重复间隔：3秒  
   - 最大执行次数：0（无限制）
   调度结束标记
```

这样就实现了类似以下JavaScript代码的功能：
```javascript
function repeatTask() {
    console.log('执行定时检查');
    // 具体检查逻辑
    
    // 等待一段时间后再次执行
    setTimeout(repeatTask, 3000);
}
```

## 优势特点

- **控制结构**: 创建任务采用控制结构，用户可以直观地在指令块中定义任务逻辑
- **统一接口**: 一个调度指令支持多种执行模式
- **函数式设计**: 创建任务返回函数，更加灵活
- **状态管理**: 执行对象提供完整的状态信息和控制方法
- **类型安全**: 完整的TypeScript类型定义
- **易于控制**: 可随时查询状态、暂停、恢复、停止任务

## 注意事项
- 创建任务是控制结构，必须与"创建任务结束标记"配对使用
- 调度任务也是控制结构，必须与"调度结束标记"配对使用
- 所有时间参数以秒为单位
- 执行对象包含完整的控制方法，建议保存以便后续操作
- 重复任务建议设置合理的最大执行次数，避免无限执行
- 任务停止后无法恢复，如需重新执行请重新调度 